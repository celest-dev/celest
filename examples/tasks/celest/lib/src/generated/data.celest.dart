// Generated by Celest. This file should not be modified manually, but
// it can be checked into version control.
// ignore_for_file: type=lint, unused_local_variable, unnecessary_cast, unnecessary_import, deprecated_member_use, invalid_use_of_internal_member

library; // ignore_for_file: no_leading_underscores_for_library_prefixes

import 'package:celest/celest.dart' as _$celest;
import 'package:celest/src/core/context.dart' as _$celest;
import 'package:celest/src/runtime/data/celest_database.dart' as _$celest;
import 'package:celest_backend/src/database/task_database.dart';

/// The data services for the Celest backend.
///
/// This class provides access to the databases that are configured
/// for the current [CelestEnvironment].
class CelestData {
  const CelestData();

  /// Initializes the databases attached to this project in the given [context].
  static Future<void> init(_$celest.Context context) async {
    final tasksDatabase = await _$celest.CelestDatabase.create(
      context,
      name: 'TaskDatabase',
      factory: TaskDatabase.new,
      hostnameVariable: const _$celest.env('TASK_DATABASE_HOST'),
      tokenSecret: const _$celest.secret('TASK_DATABASE_TOKEN'),
    );
    context.put(
      _tasksDatabaseKey,
      await tasksDatabase.connect(),
    );
  }

  /// The `TaskDatabase` instance for this project.
  TaskDatabase get tasksDatabase =>
      _$celest.Context.current.expect(_tasksDatabaseKey);

  /// The context key for the [tasksDatabase] instance.
  static _$celest.ContextKey<TaskDatabase> get _tasksDatabaseKey =>
      const _$celest.ContextKey('TaskDatabase');
}
